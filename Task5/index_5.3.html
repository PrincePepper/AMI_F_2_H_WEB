<!DOCTYPE HTML>
<html lang="ru">
<head>
	<meta charset="utf-8">
	<script src="https://code.jquery.com/jquery-3.4.0.js"></script>
	<title>5.3</title>
</head>

<body>
<script>
    let m = [
        {
            text: 'Животные',
            children: [
                {
                    text: 'Млекопитающий',
                    children:
                        [
                            {
                                text: 'Коровы',
                                children: []
                            },
                            {
                                text: 'Ослы',
                                children: []
                            },
                            {
                                text: 'Собаки',
                                children: []
                            },
                            {
                                text: 'Тигры',
                                children: []
                            }
                        ]
                },
                {
                    text: 'Другие',
                    children: [
                        {
                            text: 'Змеи',
                            children: []
                        },
                        {
                            text: 'Птицы',
                            children: []
                        },
                        {
                            text: 'Ящерицы',
                            children: []
                        }
                    ]
                }
            ]
        },
        {
            text: 'Рыбы',
            children: [
                {
                    text: 'Аквариумные',
                    children: [
                        {
                            text: 'Гуппи',
                            children: []
                        },
                        {
                            text: 'Скалярии',
                            children: []
                        }
                    ]
                },
                {
                    text: 'Морские',
                    children: [
                        {
                            text: 'Морская форель',
                            children: []
                        }
                    ]
                }
            ]
        }
    ];

    function Create(m) {

        let ul = $('<ul/>')
        for (let child of m) {
            let li = $('<li/>')
            if (child.text !== undefined)
                li.append(child.text)
            if (typeof child !== 'object')
                li.append(child)
            else if (child.children !== undefined)
                li.append(Create(child.children))

            li.click(function () {
                $(this.firstElementChild).slideToggle(500)
                return false
            })
            ul.append(li)
        }
        return ul
    }
    $('li').click();

    $("body").append(Create(m))
    $("li").each(function () {
        let text = $(this).children("ul");

        console.log(text);
        console.log("Содержание элемента:\n" + text.text() + "\r\nКоличество вложенных: " + $(this).find("li").length);
    });
</script>
</body>
</html>


